import{_ as X}from"./index-0deb4903.js";import{r as G,M as Q,a as W,b as Z,c as $,d as ee}from"./my-modal-1368c22a.js";import{v as te}from"./index-2a334394.js";import{b as ne}from"./tree-b9796e69.js";import{m as _,al as ae,am as oe,X as le,Y as se,S as ie,y as ce,an as de,J as re,z as ue,ar as me,as as pe}from"./antd-a1128520.js";import{d as _e,a as K,r as x,o as fe,j as ye,a0 as v,a1 as b,a2 as O,a3 as n,c as t,u as o,E as f,af as S,a5 as ge,F as ve,aj as ke,a8 as D}from"./vue-5b89248e.js";import"./index.vue_vue_type_script_setup_true_lang-be6d18e9.js";import"./chunk-YXBPAIHU-f2871816.js";import"./context-6a3352c8.js";const we=D("span",{style:{"margin-inline-start":"1px"}},"修改",-1),xe=D("span",{style:{"margin-inline-start":"1px"}},"删除",-1),be=D("span",{style:{"margin-inline-start":"1px"}},"授权用户",-1),Se=_e({__name:"index",setup(he){const i=K({roleName:void 0,roleKey:void 0,status:void 0,time:void 0,orderNum:void 0}),U=[{title:"角色编号",dataIndex:"id",align:"center"},{title:"角色名称",dataIndex:"roleName",align:"center"},{title:"角色字符",dataIndex:"roleKey",align:"center"},{title:"显示顺序",dataIndex:"orderNum",align:"center"},{title:"状态",dataIndex:"status",align:"center",key:"status"},{title:"创建时间",dataIndex:"createTime",align:"center"},{title:"操作",dataIndex:"operation",key:"operation",align:"center"}],k=x(!1),w=x([]);fe(()=>{y()});async function y(a){k.value=!0;let e=[];if(a)e=a;else{const{data:s}=await G();e=s}e.map(s=>s.status=s.status===0),w.value=e,k.value=!1}async function Y(a){const e={...a};a.time&&a.time[0]&&Object.assign(e,{createTimeStart:a.time[0].format("YYYY-MM-DD HH:mm:ss")}),a.time&&a.time[1]&&Object.assign(e,{createTimeEnd:a.time[1].format("YYYY-MM-DD HH:mm:ss")}),k.value=!0;const{data:s}=await W(e);await y(s)}async function B(a,e){(await Z(a,e?0:1).catch(p=>{_.warn(p),w.value=w.value.map(u=>(a===u.id&&setTimeout(()=>{u.isDisable=!u.isDisable},500),u))})).code===200&&(e?_.success("已启用"):_.info("已停用"))}const c=K({selectedRowKeys:[],loading:!1}),F=ye(()=>c.selectedRowKeys.length>0&&c.selectedRowKeys.length===1);function T(a){c.selectedRowKeys=a}const r=K({open:!1,title:""});function V(){r.open=!1}const R=x(),h=x();function I(a,e){if(e===0){ae.confirm({title:"注意",icon:t(oe),content:`确定删除编号为 【${a.join(",")}】 的角色吗？`,okText:"确认",cancelText:"取消",onOk:()=>{$(a).then(s=>{s.code===200&&(_.success("删除成功"),c.selectedRowKeys=[],y())})}});return}$(a).then(s=>{s.code===200&&(_.success("删除成功"),c.selectedRowKeys=[],y())})}async function C(a){const{data:e}=await te(1);if(R.value=ne(e),a){const{data:s}=await ee(a);h.value=s,r.open=!0,r.title="修改角色"}else h.value={},r.open=!0,r.title="添加角色"}return(a,e)=>{const s=le,p=se,u=ie,j=ce,E=de,H=v("PlusOutlined"),m=re,N=v("FileSyncOutlined"),M=v("DeleteOutlined"),z=v("VerticalAlignBottomOutlined"),A=ue,P=me,q=v("KeyOutlined"),J=pe,L=X;return b(),O(L,{"form-state":o(i),"onUpdate:refreshFunc":y,"onUpdate:onFinish":Y},{"form-items":n(()=>[t(p,{label:"角色名称",name:"roleName"},{default:n(()=>[t(s,{value:o(i).roleName,"onUpdate:value":e[0]||(e[0]=l=>o(i).roleName=l),placeholder:"请输入角色名称",style:{width:"250px"}},null,8,["value"])]),_:1}),t(p,{label:"角色字符",name:"roleKey"},{default:n(()=>[t(s,{value:o(i).roleKey,"onUpdate:value":e[1]||(e[1]=l=>o(i).roleKey=l),placeholder:"请输入角色字符",style:{width:"250px"}},null,8,["value"])]),_:1}),t(p,{label:"状态",name:"status",style:{width:"240px"}},{default:n(()=>[t(j,{value:o(i).status,"onUpdate:value":e[2]||(e[2]=l=>o(i).status=l),placeholder:"用户状态"},{default:n(()=>[t(u,{value:0},{default:n(()=>[f(" 正常 ")]),_:1}),t(u,{value:1},{default:n(()=>[f(" 停用 ")]),_:1})]),_:1},8,["value"])]),_:1}),t(p,{label:"创建时间",name:"time"},{default:n(()=>[t(E,{value:o(i).time,"onUpdate:value":e[3]||(e[3]=l=>o(i).time=l),placeholder:["开始时间","结束时间"]},null,8,["value"])]),_:1})]),"operate-btn":n(()=>[t(m,{type:"primary",onClick:e[4]||(e[4]=l=>C())},{icon:n(()=>[t(H)]),default:n(()=>[f(" 新增 ")]),_:1}),t(m,{class:"green",disabled:!o(F),onClick:e[5]||(e[5]=l=>C(o(c).selectedRowKeys[0]))},{icon:n(()=>[t(N)]),default:n(()=>[f(" 修改 ")]),_:1},8,["disabled"]),t(m,{type:"dashed",danger:"",ghost:"",disabled:!(o(c).selectedRowKeys.length>0),onClick:e[6]||(e[6]=l=>I(o(c).selectedRowKeys,0))},{icon:n(()=>[t(M)]),default:n(()=>[f(" 删除 ")]),_:1},8,["disabled"]),t(m,{class:"orange",onClick:e[7]||(e[7]=l=>o(_).warn("别点了，有空再写"))},{icon:n(()=>[t(z)]),default:n(()=>[f(" 导出 ")]),_:1})]),"table-content":n(()=>[t(J,{columns:U,"data-source":o(w),loading:o(k),"row-selection":{selectedRowKeys:o(c).selectedRowKeys,onChange:T},"row-key":l=>l.id,size:"small"},{bodyCell:n(({column:l,record:d})=>[l.key==="status"?(b(),O(A,{key:0,checked:d.status,"onUpdate:checked":g=>d.status=g,onChange:g=>B(d.id,d.status)},null,8,["checked","onUpdate:checked","onChange"])):S("",!0),l.key==="operation"?(b(),ge(ve,{key:1},[t(m,{type:"link",style:{padding:"0"},onClick:g=>C(d.id)},{icon:n(()=>[t(N)]),default:n(()=>[we]),_:2},1032,["onClick"]),t(P,{title:"是否确定删除","ok-text":"Yes","cancel-text":"No",onConfirm:g=>I([d.id])},{default:n(()=>[t(m,{type:"link",style:{padding:"0","margin-left":"5px"}},{icon:n(()=>[t(M)]),default:n(()=>[xe]),_:1})]),_:2},1032,["onConfirm"]),t(m,{type:"link",style:{padding:"0","margin-left":"5px"},onClick:g=>a.$router.push({path:"/role/authorization",query:{id:d.id,name:d.roleName}})},{icon:n(()=>[t(q)]),default:n(()=>[be]),_:2},1032,["onClick"])],64)):l.key==="icon"?(b(),O(ke(d.icon),{key:2})):S("",!0)]),_:1},8,["data-source","loading","row-selection","row-key"]),t(Q,{open:o(r).open,title:o(r).title,"tree-data":o(R),"form-data":o(h),"onUpdate:close":V},null,8,["open","title","tree-data","form-data"])]),_:1},8,["form-state"])}}});export{Se as default};
