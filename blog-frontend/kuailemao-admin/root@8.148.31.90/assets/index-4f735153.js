import{_ as Z}from"./index-0deb4903.js";import{N as ee}from"./index-b423210f.js";import{m as p,at as I,d as Y,al as O,am as te,X as ne,Y as ae,S as oe,y as se,an as le,J as ie,z as ce,ar as de,x as ue,as as me}from"./antd-a1128520.js";import{t as pe,n as B,s as re}from"./index-2a334394.js";import{d as _e,a as T,o as fe,r as R,a0 as U,a1 as h,a2 as b,a3 as t,c as n,u as o,E as m,a8 as r,af as v,a5 as K,F as V,ae as C}from"./vue-5b89248e.js";import"./index.vue_vue_type_script_setup_true_lang-be6d18e9.js";import"./chunk-YXBPAIHU-f2871816.js";import"./context-6a3352c8.js";async function ge(){return pe("/leaveWord/back/list").catch(u=>p.warn(u))}async function he(u){return B("/leaveWord/back/search",u).catch(i=>p.warn(i))}async function ke(u){return B("/leaveWord/back/isCheck",u).catch(i=>p.warn(i))}async function L(u){return re("/leaveWord/back/delete",JSON.stringify(u)).catch(i=>p.warn(i))}const ye={style:{color:"#1677FF"}},ve=r("span",{style:{"margin-left":"0.2rem"}},"查看留言",-1),Ce=["href"],we=r("span",{style:{"margin-left":"3px"}},"跳转",-1),xe=r("span",{style:{"margin-left":"3px"}},"查看",-1),be=r("span",{style:{"margin-left":"3px"}},"删除",-1),Oe=_e({__name:"index",setup(u){const i=T({userName:void 0,isCheck:void 0,time:void 0});fe(async()=>{await w()});const f=T({selectedRowKeys:[],loading:!1}),k=R(!1),y=R([]);function S(a){f.selectedRowKeys=a}const H=[{title:"编号",dataIndex:"id",align:"center"},{title:"留言用户",dataIndex:"userName",align:"center"},{title:"留言内容",dataIndex:"content",align:"center"},{title:"是否通过",dataIndex:"isCheck",align:"center"},{title:"留言时间",dataIndex:"createTime",align:"center"},{title:"更新时间",dataIndex:"updateTime",align:"center"},{title:"操作",dataIndex:"operation",align:"center"}];async function w(){k.value=!0;const{data:a}=await ge();a&&a.length>0&&(y.value=a.map(e=>(e.isCheck=e.isCheck===1,e))),k.value=!1}async function W(a){k.value=!0;const e={...a,startTime:a.time&&a.time.length>0?Y(a.time[0]).format("YYYY-MM-DD HH:mm:ss"):void 0,endTime:a.time&&a.time.length>0?Y(a.time[1]).format("YYYY-MM-DD HH:mm:ss"):void 0},{data:c}=await he(e);c&&c.length>0?y.value=c.map(d=>(d.isCheck=d.isCheck===1,d)):(p.warn("没有查询到相关留言"),y.value=[]),k.value=!1}function E(a,e,c){c.isCheckloading=!0,e=e?1:0,ke({id:a,isCheck:e}).then(d=>{d.code===200&&(p.success("操作成功"),c.isCheckloading=!1)})}function D(a){if(a)L(a).then(e=>{e.code===200&&(p.success("删除成功"),w())});else{const e=f.selectedRowKeys;O.confirm({title:"注意",icon:n(te),content:`确定删除编号为 【${e.join(",")}】 的留言吗？`,okText:"确认",cancelText:"取消",onOk:()=>{L(e).then(c=>{c.code===200&&(p.success("删除成功"),w())})}})}}const _=T({show:!1,content:""});function M(a){var e;a||(a=f.selectedRowKeys[0]),_.show=!0,_.content=(e=y.value.find(c=>c.id===a))==null?void 0:e.content}const j="http://localhost:99";return(a,e)=>{const c=ne,d=ae,N=oe,z=se,J=le,g=ie,$=U("DeleteOutlined"),P=O,G=ce,X=U("LinkOutlined"),q=de,F=ue,A=me,Q=Z;return h(),b(Q,{"form-state":o(i),"onUpdate:refreshFunc":w,"onUpdate:onFinish":W},{"form-items":t(()=>[n(d,{label:"用户名称",name:"userName",style:{"margin-right":"1rem"}},{default:t(()=>[n(c,{value:o(i).userName,"onUpdate:value":e[0]||(e[0]=s=>o(i).userName=s),placeholder:"输入留言用户",style:{width:"15em"}},null,8,["value"])]),_:1}),n(d,{label:"是否通过",name:"isCheck",style:{"margin-right":"1rem"}},{default:t(()=>[n(z,{value:o(i).isCheck,"onUpdate:value":e[1]||(e[1]=s=>o(i).isCheck=s),style:{width:"13em"},placeholder:"是否通过"},{default:t(()=>[n(N,{value:1},{default:t(()=>[m(" 是 ")]),_:1}),n(N,{value:0},{default:t(()=>[m(" 否 ")]),_:1})]),_:1},8,["value"])]),_:1}),n(d,{label:"创建时间",name:"time"},{default:t(()=>[n(J,{value:o(i).time,"onUpdate:value":e[2]||(e[2]=s=>o(i).time=s),placeholder:["开始时间","结束时间"]},null,8,["value"])]),_:1})]),"operate-btn":t(()=>[n(g,{type:"default",style:{"margin-right":"10px"},disabled:o(f).selectedRowKeys.length!==1,onClick:e[3]||(e[3]=s=>M())},{icon:t(()=>[n(o(I))]),default:t(()=>[m(" 查看 ")]),_:1},8,["disabled"]),n(g,{type:"dashed",danger:"",ghost:"",disabled:o(f).selectedRowKeys.length===0,onClick:e[4]||(e[4]=s=>D())},{icon:t(()=>[n($)]),default:t(()=>[m(" 删除 ")]),_:1},8,["disabled"]),n(P,{open:o(_).show,"onUpdate:open":e[7]||(e[7]=s=>o(_).show=s),width:"700px"},{title:t(()=>[r("span",ye,[n(o(I))]),ve]),footer:t(()=>[n(g,{onClick:e[5]||(e[5]=s=>o(_).show=!1)},{default:t(()=>[m(" 关闭 ")]),_:1})]),default:t(()=>[n(o(ee),{modelValue:o(_).content,"onUpdate:modelValue":e[6]||(e[6]=s=>o(_).content=s)},null,8,["modelValue"])]),_:1},8,["open"])]),"table-content":t(()=>[n(A,{columns:H,"data-source":o(y),loading:o(k),"row-selection":{selectedRowKeys:o(f).selectedRowKeys,onChange:S},"row-key":s=>s.id,size:"small"},{bodyCell:t(({column:s,record:l})=>[s.dataIndex==="isCheck"?(h(),b(G,{key:0,checked:l.isCheck,"onUpdate:checked":x=>l.isCheck=x,"checked-children":"是","un-checked-children":"否",loading:l.isCheckloading,onChange:x=>E(l.id,l.isCheck,l)},null,8,["checked","onUpdate:checked","loading","onChange"])):v("",!0),s.dataIndex==="content"?(h(),K(V,{key:1},[m(C(l.content.length>7?`${l.content.slice(0,7)}...`:l.content),1)],64)):v("",!0),s.dataIndex==="operation"?(h(),K(V,{key:2},[r("a",{href:`${o(j)}message/detail/${l.id}`,target:"_blank"},[n(g,{type:"link",style:{padding:"0"}},{icon:t(()=>[n(X)]),default:t(()=>[we]),_:1})],8,Ce),n(g,{type:"link",style:{padding:"0"},onClick:x=>M(l.id)},{icon:t(()=>[n(o(I))]),default:t(()=>[xe]),_:2},1032,["onClick"]),n(q,{title:"是否确定删除","ok-text":"Yes","cancel-text":"No",onConfirm:x=>D([l.id])},{default:t(()=>[n(g,{type:"link",style:{padding:"0"}},{icon:t(()=>[n($)]),default:t(()=>[be]),_:1})]),_:2},1032,["onConfirm"])],64)):v("",!0),s.dataIndex==="createTime"?(h(),b(F,{key:3,placement:"top"},{title:t(()=>[r("span",null,C(l.createTime),1)]),default:t(()=>[m(" "+C(l.createTime.split(" ")[0])+"... ",1)]),_:2},1024)):v("",!0),s.dataIndex==="updateTime"?(h(),b(F,{key:4,placement:"top"},{title:t(()=>[r("span",null,C(l.updateTime),1)]),default:t(()=>[m(" "+C(l.updateTime.split(" ")[0])+"... ",1)]),_:2},1024)):v("",!0)]),_:1},8,["data-source","loading","row-selection","row-key"])]),_:1},8,["form-state"])}}});export{Oe as default};
