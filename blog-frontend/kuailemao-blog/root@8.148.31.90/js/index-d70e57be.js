import{A as U,r as x,B as $,Q as q,o as w,c as v,l as a,q as t,y as o,u as s,x as c,t as A,j as b,U as T,E as p,aO as Z,aP as F,as as L,H as M,ax as O,J as j,I as D,K as H,ay as J,at as K,aM as Q,aN as G,aL as C}from"./.pnpm-a60ec0da.js";import{s as W}from"./index-2137e392.js";import{k as X,m as Y}from"./index-f983387b.js";const ee={style:{"text-align":"center"}},te={style:{"margin-top":"30px"}},oe={key:0,style:{margin:"0 20px"}},se={style:{"margin-top":"50px"}},le={style:{"margin-top":"80px"}},ae={key:1,style:{margin:"0 20px"}},ne={style:{"margin-top":"50px"}},re={style:{"margin-top":"80px"}},ie={style:{"margin-top":"20px"}},fe=U({__name:"index",setup(de){const z=T(),m=x(0),i=x(0),u=x(),l=$({email:"",code:"",password:"",password_repeat:""}),E={password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码的长度必须在 6-20 个字符之间",trigger:["blur","change"]}],password_repeat:[{validator:(n,e,d)=>{e===""?d(new Error("请再次输入密码")):e!==l.password?d(new Error("两次输入的密码不一致")):d()},trigger:["blur","change"]}],email:[{required:!0,message:"请输入邮件地址",trigger:"blur"},{type:"email",message:"请输入合法的电子邮件地址",trigger:["blur","change"]}],code:[{required:!0,message:"请输入获取的验证码",trigger:"blur"}]};function R(){V?(i.value=60,W(l.email,"reset").then(n=>{n.code===200?(p.success(`验证码已发送到邮箱：${l.email}，请注意查收`),setInterval(()=>i.value--,1e3)):(p.warning(n.msg),i.value=0)})):p.warning("请输入正确的电子邮件")}const V=q(()=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(l.email));function B(){u.value.validate(n=>{n&&X(l).then(e=>{e.code===200?(console.log(e),m.value++):p.warning(e.msg)})})}function I(){u.value.validate(n=>{n&&Y(l).then(e=>{e.code===200?(p.success("密码重置成功，请重新登录"),z.push("/login")):p.warning(e.msg)})})}return(n,e)=>{const d=Z,N=F,_=L,f=M,g=O,k=j,y=D,P=H,h=J,S=K;return w(),v("div",ee,[a("div",te,[t(N,{"align-center":"",active:s(m),"finish-status":"success"},{default:o(()=>[t(d,{title:"验证电子邮件"}),t(d,{title:"重写设定密码"})]),_:1},8,["active"])]),s(m)===0?(w(),v("div",oe,[e[6]||(e[6]=a("div",{style:{"margin-top":"80px"}},[a("div",{style:{"font-size":"25px","font-weight":"bold"}},"重置密码"),a("div",{style:{"font-size":"14px",color:"grey","margin-top":"1rem"}},"请输入需要重置密码的电子邮件地址")],-1)),a("div",se,[t(h,{model:s(l),rules:E,ref_key:"formRef",ref:u},{default:o(()=>[t(g,{prop:"email"},{default:o(()=>[t(f,{modelValue:s(l).email,"onUpdate:modelValue":e[0]||(e[0]=r=>s(l).email=r),type:"email",placeholder:"电子邮件地址"},{prefix:o(()=>[t(_,null,{default:o(()=>[t(s(Q))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(g,{prop:"code"},{default:o(()=>[t(P,{gutter:10,style:{width:"100%"}},{default:o(()=>[t(k,{span:17},{default:o(()=>[t(f,{modelValue:s(l).code,"onUpdate:modelValue":e[1]||(e[1]=r=>s(l).code=r),maxlength:"6",placeholder:"请输入验证码"},{prefix:o(()=>[t(_,null,{default:o(()=>[t(s(G))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(k,{span:5},{default:o(()=>[t(y,{type:"success",onClick:R,disabled:!s(V)||s(i)>0},{default:o(()=>[c(A(s(i)>0?`请稍后 ${s(i)} 秒`:"获取验证码"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),a("div",le,[t(y,{onClick:B,type:"warning",style:{width:"270px"},plain:""},{default:o(()=>e[5]||(e[5]=[c("开始重置密码")])),_:1})])])):b("",!0),s(m)===1?(w(),v("div",ae,[e[8]||(e[8]=a("div",null,[a("div",{style:{"margin-top":"80px"}},[a("div",{style:{"font-size":"25px","font-weight":"bold"}},"重置密码"),a("div",{style:{"font-size":"14px",color:"grey","margin-top":"1rem"}},"请填写你的新密码，务必牢记，防止丢失")])],-1)),a("div",ne,[t(h,{model:s(l),rules:E,ref_key:"formRef",ref:u},{default:o(()=>[t(g,{prop:"password"},{default:o(()=>[t(f,{modelValue:s(l).password,"onUpdate:modelValue":e[2]||(e[2]=r=>s(l).password=r),maxlength:"20",type:"password",placeholder:"密码"},{prefix:o(()=>[t(_,null,{default:o(()=>[t(s(C))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(g,{prop:"password_repeat"},{default:o(()=>[t(f,{modelValue:s(l).password_repeat,"onUpdate:modelValue":e[3]||(e[3]=r=>s(l).password_repeat=r),maxlength:"20",type:"password",placeholder:"重复密码"},{prefix:o(()=>[t(_,null,{default:o(()=>[t(s(C))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),a("div",re,[t(y,{type:"danger",style:{width:"270px"},plain:"",onClick:I},{default:o(()=>e[7]||(e[7]=[c("立即重置密码")])),_:1})])])):b("",!0),a("div",ie,[e[10]||(e[10]=a("span",{style:{"font-size":"14px","line-height":"15px",color:"grey"}},"改变注意?",-1)),t(S,{style:{translate:"0 -1px"},onClick:e[4]||(e[4]=r=>n.$router.push("/login"))},{default:o(()=>e[9]||(e[9]=[c("返回登录")])),_:1})])])}}});export{fe as default};
