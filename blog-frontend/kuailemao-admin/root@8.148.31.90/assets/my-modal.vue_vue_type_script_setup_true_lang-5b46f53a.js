import{d as G,ap as J,r as v,j as M,w as P,a as F,a1 as p,a2 as R,a3 as e,c as t,a8 as X,u as I,E as _,a5 as Y,F as A,af as H}from"./vue-5b89248e.js";import{t as K,n as L,s as Q}from"./index-2a334394.js";import{m as d,aC as W,R as Z,X as $,Y as ee,J as ae,U as te,a0 as ne,as as oe,al as se}from"./antd-a1128520.js";async function de(n,s,m){return K("/user/role/user/list",null,{params:{roleId:n,username:s,email:m}}).catch(i=>d.warn(i))}async function D(n,s,m){return K("/user/role/not/user/list",null,{params:{roleId:n,username:s,email:m}}).catch(i=>d.warn(i))}async function le(n){return L("/user/role/add",n).catch(s=>d.warn(s))}async function me(n){return Q("/user/role/delete",n).catch(s=>d.warn(s))}const re={style:{display:"flex"}},fe=G({__name:"my-modal",props:{open:Boolean,title:String,formData:Object},emits:["update:close"],setup(n,{emit:s}){const m=n,i=s,f=J(),U=[{title:"角色编号",dataIndex:"id",align:"center"},{title:"用户名称",dataIndex:"username",align:"center"},{title:"用户昵称",dataIndex:"nickname",align:"center"},{title:"邮箱",dataIndex:"email",align:"center"},{title:"状态",dataIndex:"isDisable",align:"center",key:"isDisable"},{title:"创建时间",dataIndex:"createTime",align:"center"}],y=v(!1),h=v([]);async function k(o){y.value=!0;let a=[];if(o){const{data:r}=await D(f.query.id,o.username,o.email);a=r}else{const{data:r}=await D(f.query.id);r&&(a=r)}h.value=a,y.value=!1}const b=v();function q(){b.value.resetFields()}const g=M(()=>m.open);P(g,o=>{o&&k()});function B(){i("update:close",!1)}const c=F({selectedRowKeys:[],loading:!1});function O(o){c.selectedRowKeys=o}async function N(){if(c.selectedRowKeys.length>0&&f.query.id){const o={userId:c.selectedRowKeys,roleId:f.query.id};(await le(o)).code===200&&d.success("授权成功，请重新登录后生效")}i("update:close",!1,c.selectedRowKeys),c.selectedRowKeys=[]}const u=F({username:void 0,email:void 0});function S(){k(u)}function V(){d.error("出现问题")}return(o,a)=>{const r=$,w=ee,x=ae,j=te,C=ne,E=oe,T=se;return p(),R(T,{open:g.value,"onUpdate:open":a[2]||(a[2]=l=>g.value=l),width:"50%",title:n.title,onOk:N,onCancel:B},{default:e(()=>[t(j,{ref_key:"formRef",ref:b,style:{"margin-top":"2rem"},model:u,colon:!1,onSubmit:S,onFinishFailed:V},{default:e(()=>[X("div",re,[t(w,{label:"用户名称",name:"username",style:{"margin-right":"1rem"}},{default:e(()=>[t(r,{value:u.username,"onUpdate:value":a[0]||(a[0]=l=>u.username=l),placeholder:"请输入用户名称"},null,8,["value"])]),_:1}),t(w,{label:"电子邮箱",name:"email",style:{"margin-right":"2rem"}},{default:e(()=>[t(r,{value:u.email,"onUpdate:value":a[1]||(a[1]=l=>u.email=l),placeholder:"请输入电子邮箱",style:{width:"220px"}},null,8,["value"])]),_:1}),t(w,null,{default:e(()=>[t(x,{type:"primary","html-type":"submit"},{icon:e(()=>[t(I(W))]),default:e(()=>[_(" 搜索 ")]),_:1}),t(x,{style:{"margin-left":"10px"},onClick:q},{icon:e(()=>[t(I(Z))]),default:e(()=>[_(" 重置 ")]),_:1})]),_:1})])]),_:1},8,["model"]),t(E,{columns:U,"data-source":h.value,loading:y.value,"row-selection":{selectedRowKeys:c.selectedRowKeys,onChange:O},"row-key":l=>l.id,size:"small"},{bodyCell:e(({column:l,record:z})=>[l.key==="isDisable"?(p(),Y(A,{key:0},[z.isDisable===0?(p(),R(C,{key:0,color:"green"},{default:e(()=>[_(" 正常 ")]),_:1})):(p(),R(C,{key:1,color:"red"},{default:e(()=>[_(" 停用 ")]),_:1}))],64)):H("",!0)]),_:1},8,["data-source","loading","row-selection","row-key"])]),_:1},8,["open","title"])}}});export{fe as _,me as d,de as q};
