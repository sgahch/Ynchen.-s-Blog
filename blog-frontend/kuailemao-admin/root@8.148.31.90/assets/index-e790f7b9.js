import{_ as P}from"./index-0deb4903.js";import{t as z,n as G,s as J}from"./index-2a334394.js";import{m as p,al as C,am as D,X,Y as q,S as Q,y as W,an as Z,J as ee,x as te,a0 as ne,as as ae}from"./antd-a1128520.js";import{d as oe,a as O,r as Y,o as se,a0 as B,a1 as d,a2 as u,a3 as t,c as n,u as s,E as c,a8 as k,ae as h,af as m,a5 as R,F as T}from"./vue-5b89248e.js";import"./index.vue_vue_type_script_setup_true_lang-be6d18e9.js";import"./chunk-YXBPAIHU-f2871816.js";import"./context-6a3352c8.js";async function le(){return z("/loginLog/list").catch(_=>p.warn(_))}async function ie(_){return G("/loginLog/search",_).catch(l=>p.warn(l))}async function K(_){return J("/loginLog/delete",{ids:_}).catch(l=>p.warn(l))}const de={style:{width:"100px",display:"inline-block",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},ce={style:{width:"100px",display:"inline-block",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},ye=oe({__name:"index",setup(_){const l=O({userName:void 0,address:void 0,state:void 0,time:void 0}),F=[{title:"日志编号",dataIndex:"id",align:"center"},{title:"用户名称",dataIndex:"userName",align:"center"},{title:"登录地址",dataIndex:"ip",align:"center"},{title:"登录地点",dataIndex:"address",align:"center"},{title:"浏览器",dataIndex:"browser",align:"center"},{title:"操作系统",dataIndex:"os",align:"center"},{title:"类型",dataIndex:"type",align:"center"},{title:"登录状态",dataIndex:"state",align:"center"},{title:"操作信息",dataIndex:"message",align:"center"},{title:"登录日期",dataIndex:"loginTime",align:"center"}],x=Y(!1),g=Y([]);se(()=>{f()});async function f(a){x.value=!0;let e;if(a)e=a;else{const{data:r}=await le();e=r}e.map(r=>r.status=r.status===0),g.value=e,x.value=!1}async function M(a){const e={...a};a.time&&a.time[0]&&Object.assign(e,{loginTimeStart:a.time[0].format("YYYY-MM-DD HH:mm:ss")}),a.time&&a.time[1]&&Object.assign(e,{loginTimeEnd:a.time[1].format("YYYY-MM-DD HH:mm:ss")}),x.value=!0;const{data:r}=await ie(e);await f(r)}const y=O({selectedRowKeys:[],loading:!1});function S(a){y.selectedRowKeys=a}function U(a){C.confirm({title:"注意",icon:n(D),content:`确定删除编号为 【${a.join(",")}】 的登录日志吗？`,okText:"确认",cancelText:"取消",onOk:()=>{K(a).then(e=>{e.code===200&&(p.success("删除成功"),y.selectedRowKeys=[],f())})}})}function V(){if(!g||g.value.length===0){p.warn("没有能清空的登录日志");return}const a=g.value.map(e=>e.id);C.confirm({title:"注意",icon:n(D),content:"是否要清空所有登录日志？",okText:"确认",cancelText:"取消",onOk:()=>{K(a).then(e=>{e.code===200&&(p.success("清空成功"),f())})}})}return(a,e)=>{const r=X,v=q,I=Q,$=W,E=Z,N=B("DeleteOutlined"),b=ee,H=B("VerticalAlignBottomOutlined"),L=te,w=ne,j=ae,A=P;return d(),u(A,{"form-state":s(l),"onUpdate:refreshFunc":f,"onUpdate:onFinish":M},{"form-items":t(()=>[n(v,{label:"登录地址",name:"address"},{default:t(()=>[n(r,{value:s(l).address,"onUpdate:value":e[0]||(e[0]=o=>s(l).address=o),placeholder:"请输入登录地址",style:{width:"250px"}},null,8,["value"])]),_:1}),n(v,{label:"用户名称",name:"userName"},{default:t(()=>[n(r,{value:s(l).userName,"onUpdate:value":e[1]||(e[1]=o=>s(l).userName=o),placeholder:"请输入用户名称",style:{width:"250px"}},null,8,["value"])]),_:1}),n(v,{label:"状态",name:"state",style:{"margin-left":"1.8rem"}},{default:t(()=>[n($,{value:s(l).state,"onUpdate:value":e[2]||(e[2]=o=>s(l).state=o),placeholder:"登录状态",style:{width:"250px"}},{default:t(()=>[n(I,{value:0},{default:t(()=>[c(" 成功 ")]),_:1}),n(I,{value:1},{default:t(()=>[c(" 失败 ")]),_:1})]),_:1},8,["value"])]),_:1}),n(v,{label:"登录时间",name:"time"},{default:t(()=>[n(E,{value:s(l).time,"onUpdate:value":e[3]||(e[3]=o=>s(l).time=o),placement:"topLeft",placeholder:["开始时间","结束时间"],style:{width:"250px"}},null,8,["value"])]),_:1})]),"operate-btn":t(()=>[n(b,{type:"dashed",danger:"",ghost:"",disabled:!(s(y).selectedRowKeys.length>0),onClick:e[4]||(e[4]=o=>U(s(y).selectedRowKeys))},{icon:t(()=>[n(N)]),default:t(()=>[c(" 删除 ")]),_:1},8,["disabled"]),n(b,{type:"primary",danger:"",ghost:"",onClick:e[5]||(e[5]=o=>V())},{icon:t(()=>[n(N)]),default:t(()=>[c(" 清空 ")]),_:1}),n(b,{class:"orange",onClick:e[6]||(e[6]=o=>s(p).warn("别点了，有空再写"))},{icon:t(()=>[n(H)]),default:t(()=>[c(" 导出 ")]),_:1})]),"table-content":t(()=>[n(j,{columns:F,"data-source":s(g),loading:s(x),"row-selection":{selectedRowKeys:s(y).selectedRowKeys,onChange:S},"row-key":o=>o.id,size:"small"},{bodyCell:t(({column:o,record:i})=>[o.dataIndex==="userName"&&i.userName.length>10?(d(),u(L,{key:0,placement:"top"},{title:t(()=>[k("span",null,h(i.userName),1)]),default:t(()=>[k("span",de,h(i.userName),1)]),_:2},1024)):m("",!0),o.dataIndex==="message"&&i.message.length>10?(d(),u(L,{key:1,placement:"top"},{title:t(()=>[k("span",null,h(i.message),1)]),default:t(()=>[k("span",ce,h(i.message),1)]),_:2},1024)):m("",!0),o.dataIndex==="state"?(d(),R(T,{key:2},[i.state===0?(d(),u(w,{key:0,color:"#87d068"},{default:t(()=>[c(" 成功 ")]),_:1})):(d(),u(w,{key:1,color:"#f50"},{default:t(()=>[c(" 失败 ")]),_:1}))],64)):m("",!0),o.dataIndex==="type"?(d(),R(T,{key:3},[i.type===0?(d(),u(w,{key:0,color:"#87d068"},{default:t(()=>[c(" 前台 ")]),_:1})):m("",!0),i.type===1?(d(),u(w,{key:1,color:"#2db7f5"},{default:t(()=>[c(" 后台 ")]),_:1})):m("",!0),i.type===2?(d(),u(w,{key:2,color:"red"},{default:t(()=>[c(" 违规 ")]),_:1})):m("",!0)],64)):m("",!0)]),_:1},8,["data-source","loading","row-selection","row-key"])]),_:1},8,["form-state"])}}});export{ye as default};
