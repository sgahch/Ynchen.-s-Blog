import{_ as P}from"./index-0deb4903.js";import{d as V,ap as j,r as f,a as O,o as z,j as J,a0 as y,a1 as u,a2 as p,a3 as n,c as a,E as s,a5 as S,F as X,af as F,u as Y}from"./vue-5b89248e.js";import{q as R,_ as A,d as G}from"./my-modal.vue_vue_type_script_setup_true_lang-5b46f53a.js";import{u as H}from"./multi-tab-397b678d.js";import{m as D,al as L,am as Q,X as W,Y as Z,J as ee,a0 as te,as as ne}from"./antd-a1128520.js";import"./index.vue_vue_type_script_setup_true_lang-be6d18e9.js";import"./index-2a334394.js";import"./chunk-YXBPAIHU-f2871816.js";import"./context-6a3352c8.js";const _e=V({__name:"index",setup(ae){const i=j(),U=H();function q(){U.close(i.fullPath)}const I=[{title:"用户编号",dataIndex:"id",align:"center"},{title:"用户名称",dataIndex:"username",align:"center"},{title:"用户昵称",dataIndex:"nickname",align:"center"},{title:"邮箱",dataIndex:"email",align:"center"},{title:"状态",dataIndex:"isDisable",align:"center",key:"isDisable"},{title:"创建时间",dataIndex:"createTime",align:"center"},{title:"操作",dataIndex:"operation",key:"operation",align:"center"}],d=f(!1),g=f([]),_=O({selectedRowKeys:[],loading:!1});function T(t){_.selectedRowKeys=t}z(()=>{r()});async function r(t){d.value=!0;let e=[];if(t)e=t;else{const{data:l}=await R(i.query.id);l&&(e=l)}g.value=e,d.value=!1}const c=O({username:void 0,email:void 0});async function $(t){d.value=!0;const{data:e}=await R(i.query.id,t.username,t.email);await r(e)}const k=f(!1);function x(t,e){!t&&e&&e.length>0&&r(),k.value=t}async function v(t){if(!t||t.length===0){D.error("请勾选要取消授权的用户");return}const e={roleId:i.query.id,userId:t};L.confirm({title:"注意",icon:a(Q),content:`确定取消授权该编号为 【${t.join(",")}】 的用户吗？`,okText:"确认",cancelText:"取消",onOk:async()=>{(await G(e)).code===200&&(D.success("成功取消授权，请重新登录后生效"),await r())}})}const B=J(()=>`授权 “${i.query.name}” 角色`);return(t,e)=>{const l=W,C=Z,K=y("PlusOutlined"),m=ee,w=y("CloseCircleOutlined"),E=y("CloseOutlined"),b=te,M=ne,N=P;return u(),p(N,{"form-state":c,"onUpdate:refreshFunc":r,"onUpdate:onFinish":$},{"form-items":n(()=>[a(C,{label:"用户名称",name:"username"},{default:n(()=>[a(l,{value:c.username,"onUpdate:value":e[0]||(e[0]=o=>c.username=o),style:{width:"250px"},placeholder:"请输入用户名称"},null,8,["value"])]),_:1}),a(C,{label:"用户邮箱",name:"email"},{default:n(()=>[a(l,{value:c.email,"onUpdate:value":e[1]||(e[1]=o=>c.email=o),style:{width:"250px"},placeholder:"请输入用户邮箱"},null,8,["value"])]),_:1})]),"operate-btn":n(()=>[a(m,{type:"primary",style:{"margin-right":"10px"},onClick:e[2]||(e[2]=o=>x(!0))},{icon:n(()=>[a(K)]),default:n(()=>[s(" 添加用户 ")]),_:1}),a(m,{type:"dashed",danger:"",ghost:"",style:{"margin-right":"10px"},onClick:e[3]||(e[3]=o=>v(_.selectedRowKeys))},{icon:n(()=>[a(w)]),default:n(()=>[s(" 批量取消授权 ")]),_:1}),a(m,{class:"orange",style:{"margin-right":"10px"},onClick:q},{icon:n(()=>[a(E)]),default:n(()=>[s(" 关闭 ")]),_:1})]),"table-content":n(()=>[a(M,{columns:I,"data-source":g.value,loading:d.value,"row-selection":{selectedRowKeys:_.selectedRowKeys,onChange:T},"row-key":o=>o.id,size:"small"},{bodyCell:n(({column:o,record:h})=>[o.key==="isDisable"?(u(),S(X,{key:0},[h.isDisable===0?(u(),p(b,{key:0,color:"green"},{default:n(()=>[s(" 正常 ")]),_:1})):(u(),p(b,{key:1,color:"red"},{default:n(()=>[s(" 停用 ")]),_:1}))],64)):F("",!0),o.key==="operation"?(u(),p(m,{key:1,type:"link",onClick:oe=>v([h.id])},{icon:n(()=>[a(w)]),default:n(()=>[s(" 取消授权 ")]),_:2},1032,["onClick"])):F("",!0)]),_:1},8,["data-source","loading","row-selection","row-key"]),a(A,{open:k.value,title:Y(B),"onUpdate:close":x},null,8,["open","title"])]),_:1},8,["form-state"])}}});export{_e as default};
