import{_ as Q}from"./index-0deb4903.js";import{t as T,n as $,s as W,v as Z}from"./index-2a334394.js";import{b as ee}from"./tree-b9796e69.js";import{m as d,al as Y,am as te,X as ae,Y as ne,an as oe,J as se,a0 as le,ar as ie,as as ce}from"./antd-a1128520.js";import{a as re}from"./index-9c46efc7.js";import{d as de,a as h,r as k,o as ue,j as me,a0 as C,a1 as _,a2 as v,a3 as a,c as n,u as o,E as g,ae as B,af as N,a5 as pe,F as fe,aj as ge,a8 as M}from"./vue-5b89248e.js";import"./index.vue_vue_type_script_setup_true_lang-be6d18e9.js";import"./chunk-YXBPAIHU-f2871816.js";import"./context-6a3352c8.js";async function ye(){return T("/category/back/list").catch(r=>d.warn(r))}async function _e(r){return $("/category/back/search",r).catch(i=>d.warn(i))}async function we(r){return T(`/category/back/get/${r}`).catch(i=>d.warn(i))}async function ke(r){return $("/category/back/update",r).catch(i=>d.warn(i))}async function F(r){return W("/category/back/delete",JSON.stringify(r)).catch(i=>d.warn(i))}const Ce=M("span",{style:{"margin-inline-start":"1px"}},"修改",-1),ve=M("span",{style:{"margin-inline-start":"1px"}},"删除",-1),Ye=de({__name:"index",setup(r){const i=h({categoryName:void 0,time:void 0}),S=[{title:"分类编号",dataIndex:"id",align:"center"},{title:"分类名称",dataIndex:"categoryName",align:"center"},{title:"文章数量",dataIndex:"articleCount",align:"center"},{title:"创建时间",dataIndex:"createTime",align:"center"},{title:"更新时间",dataIndex:"updateTime",align:"center"},{title:"操作",dataIndex:"operation",key:"operation",align:"center"}],w=k(!1),O=k([]);ue(()=>{p()});async function p(t){w.value=!0;let e=[];if(t)e=t;else{const{data:l}=await ye();e=l}e.map(l=>l.status=l.status===0),O.value=e,w.value=!1}async function U(t){const e={...t};t.time&&t.time[0]&&t.time&&t.time[1]&&Object.assign(e,{startTime:t.time[0].format("YYYY-MM-DD HH:mm:ss"),endTime:t.time[1].format("YYYY-MM-DD HH:mm:ss")}),w.value=!0;const{data:l}=await _e(e);await p(l)}const u=h({selectedRowKeys:[],loading:!1}),V=me(()=>u.selectedRowKeys.length>0&&u.selectedRowKeys.length===1);function j(t){u.selectedRowKeys=t}const c=h({open:!1,title:"",loading:!1}),H=k(),m=k();function I(t,e){if(e===0){Y.confirm({title:"注意",icon:n(te),content:`确定删除编号为 【${t.join(",")}】 的分类吗？`,okText:"确认",cancelText:"取消",onOk:()=>{F(t).then(l=>{l.code===200&&(d.success("删除成功"),u.selectedRowKeys=[],p())})}});return}F(t).then(l=>{l.code===200&&(d.success("删除成功"),u.selectedRowKeys=[],p())})}async function x(t){const{data:e}=await Z(1);if(H.value=ee(e),t){const{data:l}=await we(t);m.value=l,c.open=!0,c.title="修改分类"}else m.value={},c.open=!0,c.title="添加分类"}async function P(){c.loading=!0,m.value.id?await ke(m.value).then(t=>{t.code===200&&(c.loading=!1,d.success("修改成功"))}):await re(m.value).then(t=>{t.code===200&&(c.loading=!1,d.success("添加成功"))}),c.open=!1,await p()}return(t,e)=>{const l=ae,b=ne,A=oe,E=C("PlusOutlined"),f=se,D=C("FileSyncOutlined"),R=C("DeleteOutlined"),J=C("VerticalAlignBottomOutlined"),z=Y,K=le,G=ie,L=ce,X=Q;return _(),v(X,{"form-state":o(i),"onUpdate:refreshFunc":p,"onUpdate:onFinish":U},{"form-items":a(()=>[n(b,{label:"分类名称",name:"categoryName"},{default:a(()=>[n(l,{value:o(i).categoryName,"onUpdate:value":e[0]||(e[0]=s=>o(i).categoryName=s),placeholder:"请输入分类名称",style:{width:"250px"}},null,8,["value"])]),_:1}),n(b,{label:"创建时间",name:"time"},{default:a(()=>[n(A,{value:o(i).time,"onUpdate:value":e[1]||(e[1]=s=>o(i).time=s),placeholder:["开始时间","结束时间"]},null,8,["value"])]),_:1})]),"operate-btn":a(()=>[n(f,{type:"primary",onClick:e[2]||(e[2]=s=>x())},{icon:a(()=>[n(E)]),default:a(()=>[g(" 新增 ")]),_:1}),n(f,{class:"green",disabled:!o(V),onClick:e[3]||(e[3]=s=>x(o(u).selectedRowKeys[0]))},{icon:a(()=>[n(D)]),default:a(()=>[g(" 修改 ")]),_:1},8,["disabled"]),n(f,{type:"dashed",danger:"",ghost:"",disabled:!(o(u).selectedRowKeys.length>0),onClick:e[4]||(e[4]=s=>I(o(u).selectedRowKeys,0))},{icon:a(()=>[n(R)]),default:a(()=>[g(" 删除 ")]),_:1},8,["disabled"]),n(f,{class:"orange",onClick:e[5]||(e[5]=s=>o(d).warn("别点了，有空再写"))},{icon:a(()=>[n(J)]),default:a(()=>[g(" 导出 ")]),_:1})]),"table-content":a(()=>[n(z,{open:o(c).open,"onUpdate:open":e[7]||(e[7]=s=>o(c).open=s),title:o(c).title,"confirm-loading":o(c).loading,width:"400px",onOk:P},{default:a(()=>[n(b,{label:"分类名称",name:"categoryName"},{default:a(()=>[n(l,{value:o(m).categoryName,"onUpdate:value":e[6]||(e[6]=s=>o(m).categoryName=s),placeholder:"请输入分类名称","show-count":"",maxlength:20},null,8,["value"])]),_:1})]),_:1},8,["open","title","confirm-loading"]),n(L,{columns:S,"data-source":o(O),loading:o(w),"row-selection":{selectedRowKeys:o(u).selectedRowKeys,onChange:j},"row-key":s=>s.id,size:"small"},{bodyCell:a(({column:s,record:y})=>[s.dataIndex==="categoryName"?(_(),v(K,{key:0,color:"#2db7f5"},{default:a(()=>[g(B(y.categoryName),1)]),_:2},1024)):N("",!0),s.dataIndex==="articleCount"?(_(),v(K,{key:1},{default:a(()=>[g(B(y.articleCount),1)]),_:2},1024)):N("",!0),s.key==="operation"?(_(),pe(fe,{key:2},[n(f,{type:"link",style:{padding:"0"},onClick:q=>x(y.id)},{icon:a(()=>[n(D)]),default:a(()=>[Ce]),_:2},1032,["onClick"]),n(G,{title:"是否确定删除","ok-text":"Yes","cancel-text":"No",onConfirm:q=>I([y.id])},{default:a(()=>[n(f,{type:"link",style:{padding:"0","margin-left":"5px"}},{icon:a(()=>[n(R)]),default:a(()=>[ve]),_:1})]),_:2},1032,["onConfirm"])],64)):s.key==="icon"?(_(),v(ge(y.icon),{key:3})):N("",!0)]),_:1},8,["data-source","loading","row-selection","row-key"])]),_:1},8,["form-state"])}}});export{Ye as default};
