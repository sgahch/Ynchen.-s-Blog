import{_ as W}from"./index-0deb4903.js";import{t as $,n as M,q as Z,s as ee,v as te}from"./index-2a334394.js";import{b as ae}from"./tree-b9796e69.js";import{m as r,al as Y,am as ne,X as oe,Y as se,an as le,J as ie,a0 as ce,ar as de,as as re}from"./antd-a1128520.js";import{d as ue,a as C,r as v,o as me,j as pe,a0 as _,a1 as y,a2 as b,a3 as a,c as n,u as o,E as w,a8 as T,ae as B,af as O,a5 as ge,F as fe,aj as _e}from"./vue-5b89248e.js";import"./index.vue_vue_type_script_setup_true_lang-be6d18e9.js";import"./chunk-YXBPAIHU-f2871816.js";import"./context-6a3352c8.js";async function ye(){return $("/tag/back/list").catch(d=>r.warn(d))}async function we(d){return M("/tag/back/search",d).catch(l=>r.warn(l))}async function ke(d){return $(`/tag/back/get/${d}`).catch(l=>r.warn(l))}async function ve(d){return Z("/tag/back/add",d).catch(l=>r.warn(l))}async function be(d){return M("/tag/back/update",d).catch(l=>r.warn(l))}async function F(d){return ee("/tag/back/delete",JSON.stringify(d)).catch(l=>r.warn(l))}const xe=T("span",{style:{"margin-inline-start":"1px"}},"修改",-1),he=T("span",{style:{"margin-inline-start":"1px"}},"删除",-1),Ye=ue({__name:"index",setup(d){const l=C({tagName:void 0,time:void 0}),S=[{title:"标签编号",dataIndex:"id",align:"center"},{title:"标签名称",dataIndex:"tagName",align:"center"},{title:"文章数量",dataIndex:"articleCount",align:"center"},{title:"创建时间",dataIndex:"createTime",align:"center"},{title:"更新时间",dataIndex:"updateTime",align:"center"},{title:"操作",dataIndex:"operation",key:"operation",align:"center"}],k=v(!1),N=v([]);me(()=>{p()});async function p(t){k.value=!0;let e=[];if(t)e=t;else{const{data:i}=await ye();e=i}e.map(i=>i.status=i.status===0),N.value=e,k.value=!1}async function U(t){const e={...t};t.time&&t.time[0]&&t.time&&t.time[1]&&Object.assign(e,{startTime:t.time[0].format("YYYY-MM-DD HH:mm:ss"),endTime:t.time[1].format("YYYY-MM-DD HH:mm:ss")}),k.value=!0;const{data:i}=await we(e);await p(i)}const u=C({selectedRowKeys:[],loading:!1}),V=pe(()=>u.selectedRowKeys.length>0&&u.selectedRowKeys.length===1);function P(t){u.selectedRowKeys=t}const c=C({open:!1,title:"",loading:!1}),j=v(),m=v();function I(t,e){if(e===0){Y.confirm({title:"注意",icon:n(ne),content:`确定删除编号为 【${t.join(",")}】 的标签吗？`,okText:"确认",cancelText:"取消",onOk:()=>{F(t).then(i=>{i.code===200&&(r.success("删除成功"),u.selectedRowKeys=[],p())})}});return}F(t).then(i=>{i.code===200&&(r.success("删除成功"),u.selectedRowKeys=[],p())})}async function x(t){const{data:e}=await te(1);if(j.value=ae(e),t){const{data:i}=await ke(t);m.value=i,c.open=!0,c.title="修改标签"}else m.value={},c.open=!0,c.title="添加标签"}async function H(){c.loading=!0,m.value.id?await be(m.value).then(t=>{c.loading=!1,t.code===200&&r.success("修改成功")}).catch():await ve(m.value).then(t=>{c.loading=!1,t.code===200&&r.success("添加成功")}).catch(()=>c.loading=!1),c.open=!1,await p()}return(t,e)=>{const i=oe,h=se,A=le,E=_("PlusOutlined"),g=ie,D=_("FileSyncOutlined"),R=_("DeleteOutlined"),J=_("VerticalAlignBottomOutlined"),q=Y,z=_("TagOutlined"),K=ce,G=de,L=re,X=W;return y(),b(X,{"form-state":o(l),"onUpdate:refreshFunc":p,"onUpdate:onFinish":U},{"form-items":a(()=>[n(h,{label:"标签名称",name:"tagName"},{default:a(()=>[n(i,{value:o(l).tagName,"onUpdate:value":e[0]||(e[0]=s=>o(l).tagName=s),placeholder:"请输入标签名称",style:{width:"250px"}},null,8,["value"])]),_:1}),n(h,{label:"创建时间",name:"time"},{default:a(()=>[n(A,{value:o(l).time,"onUpdate:value":e[1]||(e[1]=s=>o(l).time=s),placeholder:["开始时间","结束时间"]},null,8,["value"])]),_:1})]),"operate-btn":a(()=>[n(g,{type:"primary",onClick:e[2]||(e[2]=s=>x())},{icon:a(()=>[n(E)]),default:a(()=>[w(" 新增 ")]),_:1}),n(g,{class:"green",disabled:!o(V),onClick:e[3]||(e[3]=s=>x(o(u).selectedRowKeys[0]))},{icon:a(()=>[n(D)]),default:a(()=>[w(" 修改 ")]),_:1},8,["disabled"]),n(g,{type:"dashed",danger:"",ghost:"",disabled:!(o(u).selectedRowKeys.length>0),onClick:e[4]||(e[4]=s=>I(o(u).selectedRowKeys,0))},{icon:a(()=>[n(R)]),default:a(()=>[w(" 删除 ")]),_:1},8,["disabled"]),n(g,{class:"orange",onClick:e[5]||(e[5]=s=>o(r).warn("别点了，有空再写"))},{icon:a(()=>[n(J)]),default:a(()=>[w(" 导出 ")]),_:1})]),"table-content":a(()=>[n(q,{open:o(c).open,"onUpdate:open":e[7]||(e[7]=s=>o(c).open=s),title:o(c).title,"confirm-loading":o(c).loading,width:"400px",onOk:H},{default:a(()=>[n(h,{label:"标签名称",name:"tagName"},{default:a(()=>[n(i,{value:o(m).tagName,"onUpdate:value":e[6]||(e[6]=s=>o(m).tagName=s),placeholder:"请输入标签名称","show-count":"",maxlength:20},null,8,["value"])]),_:1})]),_:1},8,["open","title","confirm-loading"]),n(L,{columns:S,"data-source":o(N),loading:o(k),"row-selection":{selectedRowKeys:o(u).selectedRowKeys,onChange:P},"row-key":s=>s.id,size:"small"},{bodyCell:a(({column:s,record:f})=>[s.dataIndex==="tagName"?(y(),b(K,{key:0,color:"blue"},{default:a(()=>[n(z),T("span",null,B(f.tagName),1)]),_:2},1024)):O("",!0),s.dataIndex==="articleCount"?(y(),b(K,{key:1},{default:a(()=>[w(B(f.articleCount),1)]),_:2},1024)):O("",!0),s.key==="operation"?(y(),ge(fe,{key:2},[n(g,{type:"link",style:{padding:"0"},onClick:Q=>x(f.id)},{icon:a(()=>[n(D)]),default:a(()=>[xe]),_:2},1032,["onClick"]),n(G,{title:"是否确定删除","ok-text":"Yes","cancel-text":"No",onConfirm:Q=>I([f.id])},{default:a(()=>[n(g,{type:"link",style:{padding:"0","margin-left":"5px"}},{icon:a(()=>[n(R)]),default:a(()=>[he]),_:1})]),_:2},1032,["onConfirm"])],64)):s.key==="icon"?(y(),b(_e(f.icon),{key:3})):O("",!0)]),_:1},8,["data-source","loading","row-selection","row-key"])]),_:1},8,["form-state"])}}});export{Ye as default};
