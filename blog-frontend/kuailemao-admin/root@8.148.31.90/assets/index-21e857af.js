import{_ as M}from"./index-0deb4903.js";import{d as P,ap as V,r as f,a as b,o as j,a0 as y,a1 as c,a2 as p,a3 as n,c as a,E as s,a5 as z,F as J,af as N}from"./vue-5b89248e.js";import{q as O,_ as S,d as X}from"./my-modal.vue_vue_type_script_setup_true_lang-bc5e8974.js";import{u as Y}from"./multi-tab-397b678d.js";import{m as F,al as A,am as G,X as H,Y as L,J as Q,a0 as W,as as Z}from"./antd-a1128520.js";import"./index.vue_vue_type_script_setup_true_lang-be6d18e9.js";import"./index-2a334394.js";import"./chunk-YXBPAIHU-f2871816.js";import"./context-6a3352c8.js";const de=P({__name:"index",setup(ee){const u=V(),R=Y();function U(){R.close(u.fullPath)}const I=[{title:"角色编号",dataIndex:"id",align:"center"},{title:"角色名称",dataIndex:"roleName",align:"center"},{title:"角色字符",dataIndex:"roleKey",align:"center"},{title:"角色顺序",dataIndex:"orderNum",align:"center"},{title:"状态",dataIndex:"status",align:"center",key:"status"},{title:"创建时间",dataIndex:"createTime",align:"center"},{title:"操作",dataIndex:"operation",key:"operation",align:"center"}],d=f(!1),g=f([]),_=b({selectedRowKeys:[],loading:!1});function T(t){_.selectedRowKeys=t}j(()=>{i()});async function i(t){d.value=!0;let e=[];if(t)e=t;else{const{data:l}=await O(u.query.id);l&&(e=l)}g.value=e,d.value=!1}const r=b({roleName:void 0,roleKey:void 0});async function q(t){d.value=!0;const{data:e}=await O(u.query.id,t.roleName,t.roleKey);await i(e)}const k=f(!1);function x(t,e){!t&&e&&e.length>0&&i(),k.value=t}async function v(t){if(!t||t.length===0){F.error("请勾选要取消授权的角色");return}const e={userId:[u.query.id],roleId:t};A.confirm({title:"注意",icon:a(G),content:`确定取消授权该编号为 【${t.join(",")}】 的角色吗？`,okText:"确认",cancelText:"取消",onOk:async()=>{(await X(e)).code===200&&(F.success("成功取消授权，请重新登录后生效"),await i())}})}return(t,e)=>{const l=H,C=L,B=y("PlusOutlined"),m=Q,w=y("CloseCircleOutlined"),$=y("CloseOutlined"),h=W,D=Z,E=M;return c(),p(E,{"form-state":r,"onUpdate:refreshFunc":i,"onUpdate:onFinish":q},{"form-items":n(()=>[a(C,{label:"角色名称",name:"roleName"},{default:n(()=>[a(l,{value:r.roleName,"onUpdate:value":e[0]||(e[0]=o=>r.roleName=o),style:{width:"250px"},placeholder:"请输入角色名称"},null,8,["value"])]),_:1}),a(C,{label:"角色字符",name:"roleKey"},{default:n(()=>[a(l,{value:r.roleKey,"onUpdate:value":e[1]||(e[1]=o=>r.roleKey=o),style:{width:"250px"},placeholder:"请输入角色字符"},null,8,["value"])]),_:1})]),"operate-btn":n(()=>[a(m,{type:"primary",style:{"margin-right":"10px"},onClick:e[2]||(e[2]=o=>x(!0))},{icon:n(()=>[a(B)]),default:n(()=>[s(" 添加角色 ")]),_:1}),a(m,{type:"dashed",danger:"",ghost:"",style:{"margin-right":"10px"},onClick:e[3]||(e[3]=o=>v(_.selectedRowKeys))},{icon:n(()=>[a(w)]),default:n(()=>[s(" 批量取消授权 ")]),_:1}),a(m,{class:"orange",style:{"margin-right":"10px"},onClick:U},{icon:n(()=>[a($)]),default:n(()=>[s(" 关闭 ")]),_:1})]),"table-content":n(()=>[a(D,{columns:I,"data-source":g.value,loading:d.value,"row-selection":{selectedRowKeys:_.selectedRowKeys,onChange:T},"row-key":o=>o.id,size:"small"},{bodyCell:n(({column:o,record:K})=>[o.key==="status"?(c(),z(J,{key:0},[K.status===0?(c(),p(h,{key:0,color:"green"},{default:n(()=>[s(" 正常 ")]),_:1})):(c(),p(h,{key:1,color:"red"},{default:n(()=>[s(" 停用 ")]),_:1}))],64)):N("",!0),o.key==="operation"?(c(),p(m,{key:1,type:"link",onClick:te=>v([K.id])},{icon:n(()=>[a(w)]),default:n(()=>[s(" 取消授权 ")]),_:2},1032,["onClick"])):N("",!0)]),_:1},8,["data-source","loading","row-selection","row-key"]),a(S,{open:k.value,title:"授权用户","onUpdate:close":x},null,8,["open"])]),_:1},8,["form-state"])}}});export{de as default};
