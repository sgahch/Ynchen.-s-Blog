import{_ as ne}from"./index-0deb4903.js";import{b as le,c as oe,d as se,e as ie,u as ue,f as de,g as D}from"./index-9c46efc7.js";import{m as I,al as ce,am as pe,X as re,Y as _e,y as ge,n as me,S as ye,J as fe,au as he,a0 as ve,aq as ke,z as Te,ar as xe,x as we,as as Ie}from"./antd-a1128520.js";import{d as Ce,a as B,r as F,o as be,a0 as C,a1 as u,a2 as p,a3 as e,c as t,u as s,af as r,E as i,ae as g,a5 as k,F as T,ak as K,a8 as x}from"./vue-5b89248e.js";import"./index.vue_vue_type_script_setup_true_lang-be6d18e9.js";import"./index-2a334394.js";import"./chunk-YXBPAIHU-f2871816.js";import"./context-6a3352c8.js";const Ne={style:{color:"darkred"}},$e=["href"],Fe=x("span",{style:{"margin-left":"3px"}},"跳转",-1),Oe=x("span",{style:{"margin-left":"3px"}},"修改",-1),Ue=x("span",{style:{"margin-left":"3px"}},"删除",-1),ze=Ce({__name:"index",setup(Ke){const _=B({categoryId:void 0,tagId:void 0,articleTitle:void 0,articleType:void 0,isTop:void 0,status:void 0}),O=F([]),A=F([]);be(async()=>{await N(),await V(),await q()});async function V(){const{data:o}=await le();O.value=o}async function q(){const{data:o}=await oe();A.value=o}const f=B({selectedRowKeys:[],loading:!1}),w=F(!1),b=F([]);function z(o){f.selectedRowKeys=o}const E=[{title:"编号",dataIndex:"id",align:"center"},{title:"封面",dataIndex:"articleCover",align:"center"},{title:"标题",dataIndex:"articleTitle",align:"center"},{title:"类型",dataIndex:"articleType",align:"center"},{title:"分类",dataIndex:"categoryName",align:"center"},{title:"标签",dataIndex:"tagsName",align:"center"},{title:"状态",dataIndex:"status",align:"center"},{title:"是否顶置",dataIndex:"isTop",align:"center"},{title:"访问量",dataIndex:"visitCount",align:"center"},{title:"作者",dataIndex:"userName",align:"center"},{title:"发布时间",dataIndex:"createTime",align:"center"},{title:"操作",dataIndex:"operation",align:"center"}];async function N(){w.value=!0;const{data:o}=await se();o&&o.length>0&&(b.value=o.map(a=>(a.isTop=a.isTop===1,a))),w.value=!1}async function M(o){w.value=!0;const{data:a}=await ie(o);a&&a.length>0?b.value=a.map(c=>(c.isTop=c.isTop===1,c)):(I.warn("没有查询到相关文章"),b.value=[]),w.value=!1}function P(o,a,c){c.statusLoading=!0,ue({id:o,status:a}).then(m=>{m.code===200&&(I.success("状态修改成功"),c.statusLoading=!1)})}function Y(o,a,c){c.isToploading=!0,de({id:o,isTop:a?1:0}).then(m=>{m.code===200&&(I.success("操作成功"),c.isToploading=!1)})}function L(o){if(o)D(o).then(a=>{a.code===200&&(I.success("删除成功"),N())});else{const a=f.selectedRowKeys;ce.confirm({title:"注意",icon:t(pe),content:`确定删除编号为 【${a.join(",")}】 的文章吗？`,okText:"确认",cancelText:"取消",onOk:()=>{D(a).then(c=>{c.code===200&&(I.success("删除成功"),N())})}})}}const j="http://localhost:99";return(o,a)=>{const c=re,m=_e,$=ge,U=me,y=ye,J=C("PlusOutlined"),h=fe,R=C("DeleteOutlined"),S=C("FileSyncOutlined"),X=he,v=ve,G=ke,H=Te,Q=C("FireFilled"),W=C("LinkOutlined"),Z=xe,ee=we,te=Ie,ae=ne;return u(),p(ae,{"form-state":s(_),"onUpdate:refreshFunc":N,"onUpdate:onFinish":M},{"form-items":e(()=>[t(m,{label:"标题",name:"articleTitle",style:{"margin-right":"1rem"}},{default:e(()=>[t(c,{value:s(_).articleTitle,"onUpdate:value":a[0]||(a[0]=l=>s(_).articleTitle=l),placeholder:"输入文章标题",style:{width:"15em"}},null,8,["value"])]),_:1}),t(m,{label:"分类",name:"categoryId",style:{"margin-right":"1rem"}},{default:e(()=>[t(U,null,{default:e(()=>[s(O)?(u(),p($,{key:0,value:s(_).categoryId,"onUpdate:value":a[1]||(a[1]=l=>s(_).categoryId=l),placeholder:"选择分类",style:{width:"13em"},options:s(O).map(l=>({value:l.id,label:l.categoryName}))},null,8,["value","options"])):r("",!0)]),_:1})]),_:1}),t(m,{label:"状态",name:"status",style:{"margin-right":"1rem"}},{default:e(()=>[t(U,null,{default:e(()=>[t($,{value:s(_).status,"onUpdate:value":a[2]||(a[2]=l=>s(_).status=l),style:{width:"10em"},placeholder:"选择状态"},{default:e(()=>[t(y,{value:1},{default:e(()=>[i(" 公开 ")]),_:1}),t(y,{value:2},{default:e(()=>[i(" 私密 ")]),_:1}),t(y,{value:3},{default:e(()=>[i(" 草稿 ")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),t(m,{label:"是否顶置",name:"isTop",style:{"margin-right":"1rem"}},{default:e(()=>[t($,{value:s(_).isTop,"onUpdate:value":a[3]||(a[3]=l=>s(_).isTop=l),style:{width:"13em"},placeholder:"是否顶置"},{default:e(()=>[t(y,{value:1},{default:e(()=>[i(" 是 ")]),_:1}),t(y,{value:0},{default:e(()=>[i(" 否 ")]),_:1})]),_:1},8,["value"])]),_:1})]),"operate-btn":e(()=>[t(h,{type:"primary",style:{"margin-right":"10px"},onClick:a[4]||(a[4]=l=>o.$router.push({path:"/blog/essay/publish"}))},{icon:e(()=>[t(J)]),default:e(()=>[i(" 添加 ")]),_:1}),t(h,{type:"dashed",danger:"",ghost:"",disabled:s(f).selectedRowKeys.length===0,onClick:a[5]||(a[5]=l=>L())},{icon:e(()=>[t(R)]),default:e(()=>[i(" 删除 ")]),_:1},8,["disabled"]),t(h,{class:"green",style:{"margin-right":"10px"},disabled:s(f).selectedRowKeys.length===0||s(f).selectedRowKeys.length>1,onClick:a[6]||(a[6]=l=>o.$router.push({path:"/blog/essay/publish",query:{id:s(f).selectedRowKeys[0]}}))},{icon:e(()=>[t(S)]),default:e(()=>[i(" 修改 ")]),_:1},8,["disabled"])]),"table-content":e(()=>[t(te,{columns:E,"data-source":s(b),loading:s(w),"row-selection":{selectedRowKeys:s(f).selectedRowKeys,onChange:z},"row-key":l=>l.id,size:"small"},{bodyCell:e(({column:l,record:n})=>[l.dataIndex==="articleCover"?(u(),p(X,{key:0,src:n.articleCover,style:{width:"70px",height:"50px"}},null,8,["src"])):r("",!0),l.dataIndex==="categoryName"?(u(),p(v,{key:1},{default:e(()=>[i(g(n.categoryName),1)]),_:2},1024)):r("",!0),l.dataIndex==="tagsName"?(u(),k(T,{key:2},[n.tagsName.length<=2?(u(!0),k(T,{key:0},K(n.tagsName,d=>(u(),p(v,{key:d,color:"blue"},{default:e(()=>[i(g(d),1)]),_:2},1024))),128)):(u(),p(G,{key:1,trigger:"hover"},{content:e(()=>[(u(!0),k(T,null,K(n.tagsName,d=>(u(),p(v,{key:d,color:"blue"},{default:e(()=>[i(g(d),1)]),_:2},1024))),128))]),default:e(()=>[(u(!0),k(T,null,K(n.tagsName.slice(0,1),d=>(u(),p(v,{key:d,color:"blue"},{default:e(()=>[i(g(d),1)]),_:2},1024))),128)),t(v,null,{default:e(()=>[i(" +"+g(n.tagsName.length-1),1)]),_:2},1024)]),_:2},1024))],64)):r("",!0),l.dataIndex==="status"?(u(),p(U,{key:3},{default:e(()=>[t($,{value:n.status,"onUpdate:value":d=>n.status=d,style:{width:"6em"},size:"small",loading:n.statusLoading,onChange:d=>P(n.id,n.status,n)},{default:e(()=>[t(y,{value:1},{default:e(()=>[i(" 公开 ")]),_:1}),t(y,{value:2},{default:e(()=>[i(" 私密 ")]),_:1}),t(y,{value:3},{default:e(()=>[i(" 草稿 ")]),_:1})]),_:2},1032,["value","onUpdate:value","loading","onChange"])]),_:2},1024)):r("",!0),l.dataIndex==="isTop"?(u(),p(H,{key:4,checked:n.isTop,"onUpdate:checked":d=>n.isTop=d,"checked-children":"是","un-checked-children":"否",loading:n.isToploading,onChange:d=>Y(n.id,n.isTop,n)},null,8,["checked","onUpdate:checked","loading","onChange"])):r("",!0),l.dataIndex==="visitCount"?(u(),k(T,{key:5},[x("span",Ne,[t(Q)]),i(" "+g(n.visitCount),1)],64)):r("",!0),l.dataIndex==="operation"?(u(),k(T,{key:6},[x("a",{href:`${s(j)}article/${n.id}`,target:"_blank"},[t(h,{type:"link",style:{padding:"0"}},{icon:e(()=>[t(W)]),default:e(()=>[Fe]),_:1})],8,$e),t(h,{type:"link",style:{padding:"0"},onClick:d=>o.$router.push({path:"/blog/essay/publish",query:{id:n.id}})},{icon:e(()=>[t(S)]),default:e(()=>[Oe]),_:2},1032,["onClick"]),t(Z,{title:"是否确定删除","ok-text":"Yes","cancel-text":"No",onConfirm:d=>L([n.id])},{default:e(()=>[t(h,{type:"link",style:{padding:"0"}},{icon:e(()=>[t(R)]),default:e(()=>[Ue]),_:1})]),_:2},1032,["onConfirm"])],64)):r("",!0),l.dataIndex==="createTime"?(u(),p(ee,{key:7,placement:"top"},{title:e(()=>[x("span",null,g(n.createTime),1)]),default:e(()=>[i(" "+g(n.createTime.split(" ")[0])+"... ",1)]),_:2},1024)):r("",!0),l.dataIndex==="articleType"?(u(),p(v,{key:8,color:"#108ee9"},{default:e(()=>[i(g(n.articleType===1?"原创":n.articleType===2?"转载":"翻译"),1)]),_:2},1024)):r("",!0)]),_:1},8,["data-source","loading","row-selection","row-key"])]),_:1},8,["form-state"])}}});export{ze as default};
