var Z=Object.defineProperty;var D=(o,n,r)=>n in o?Z(o,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[n]=r;var f=(o,n,r)=>(D(o,typeof n!="symbol"?n+"":n,r),r);import{_ as z,h as J,u as Q,j,e as X,k as Y,f as G,a as ee,m as te,A as oe}from"./index-2a334394.js";import{a1 as _,a5 as w,a8 as a,d as ne,S as se,ad as ae,a as re,s as k,r as ie,ao as ce,o as le,u as t,l as de,a2 as M,c,a3 as m,af as q,F as ue,E as pe,ae as me,a6 as _e,a7 as he}from"./vue-5b89248e.js";import{d as ge}from"./chunk-YXBPAIHU-f2871816.js";import{Q as fe,U as ve,V as we,W as xe,H as be,N as ye,T as $e,I as ke,X as Me,Y as ze,Z as Ce,J as Le}from"./antd-a1128520.js";const Ie={name:"CarbonSun"},Se={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 32 32"},Ee=a("path",{fill:"currentColor",d:"M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6ZM5.394 6.813L6.81 5.399l3.505 3.506L8.9 10.319zM2 15.005h5v2H2zm3.394 10.193L8.9 21.692l1.414 1.414l-3.505 3.506zM15 25.005h2v5h-2zm6.687-1.9l1.414-1.414l3.506 3.506l-1.414 1.414zm3.313-8.1h5v2h-5zm-3.313-6.101l3.506-3.506l1.414 1.414l-3.506 3.506zM15 2.005h2v5h-2z"},null,-1),Re=[Ee];function qe(o,n,r,l,u,x){return _(),w("svg",Se,Re)}const Ae=z(Ie,[["render",qe]]),Be={name:"CarbonMoon"},Ue={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 32 32"},Ne=a("path",{fill:"currentColor",d:"M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3Z"},null,-1),Te=[Ne];function Fe(o,n,r,l,u,x){return _(),w("svg",Ue,Te)}const Pe=z(Be,[["render",Fe]]),Ve="/assets/login-left-73acaab3.png";function He(o,n=""){var u;const r=((u=J.currentRoute.value)==null?void 0:u.query)??{},l=fe(r,o)??n;return decodeURIComponent(l)}const e={width:0,height:0,canvas:null,ctx:null,circles:[],animate:!0,requestId:null},Ke=function(o){if(!e||!o)throw new Error("no canvasInstance");e.width=window.innerWidth,e.height=window.innerHeight,e.canvas=o,e.canvas.width=e.width,e.canvas.height=e.height,e.ctx=e.canvas.getContext("2d"),e.circles=[];for(let n=0;n<e.width*.5;n++){const r=new Oe;e.circles.push(r)}N(),We()};function B(){e.animate=!(document.body.scrollTop>e.height)}function U(){e.width=window.innerWidth,e.height=window.innerHeight,e.canvas.width=e.width,e.canvas.height=e.height}function N(){if(e.animate){e.ctx.clearRect(0,0,e.width,e.height);for(const o in e.circles)e.circles[o].draw()}e.requestId=requestAnimationFrame(N)}class Oe{constructor(){f(this,"pos");f(this,"alpha");f(this,"scale");f(this,"velocity");f(this,"draw");this.pos={x:Math.random()*e.width,y:e.height+Math.random()*100},this.alpha=.1+Math.random()*.3,this.scale=.1+Math.random()*.3,this.velocity=Math.random();const n=Math.random()*255,r=Math.random()*255,l=Math.random()*255;this.draw=function(){this.pos.y-=this.velocity,this.alpha-=5e-4,e.ctx.beginPath(),e.ctx.arc(this.pos.x,this.pos.y,this.scale*10,0,2*Math.PI,!1),e.ctx.fillStyle=`rgba(${n},${r},${l},${this.alpha})`,e.ctx.fill()}}}function We(){window.addEventListener("scroll",B),window.addEventListener("resize",U)}function Ze(){window.removeEventListener("scroll",B),window.removeEventListener("resize",U),cancelAnimationFrame(e.requestId)}const A={init:Ke,removeListeners:Ze},C=o=>(_e("data-v-d9ce77c5"),o=o(),he(),o),De={class:"login-container"},Je={"h-screen":"","w-screen":"",absolute:"","z-10":""},Qe={class:"login-content flex-center"},je={class:"ant-pro-form-login-main rounded"},Xe={class:"flex-between h-15 px-4 mb-[2px]"},Ye=C(()=>a("div",{class:"flex-end"},[a("span",{class:"ant-pro-form-login-title"}," ruyu-blog "),a("span",{class:"ant-pro-form-login-desc"}," 欢迎进入个人博客后台 ")],-1)),Ge={class:"login-lang flex-center relative z-11"},et={class:"box-border flex min-h-[520px]"},tt=C(()=>a("div",{class:"ant-pro-form-login-main-left min-h-[520px] flex-center bg-[var(--bg-color-container)]"},[a("img",{src:Ve,class:"h-5/6 w-5/6"})],-1)),ot={class:"ant-pro-form-login-main-right px-5 w-[335px] flex-center flex-col relative z-11"},nt=C(()=>a("div",{class:"text-center py-6 text-2xl"}," 欢迎登录后台系统 ",-1)),st=60,at=ne({__name:"login",setup(o){Q();const n=j(),r=X(),{layoutSetting:l}=se(r),u=ae(),x=Y(),i=re({username:"",password:void 0,mobile:void 0,code:void 0,type:"account",remember:!0}),{t:p}=G(),L=k(),b=k(!1),I=k(!1),S=ie(),{pause:T,reset:rt}=ce(1e3,{controls:!0,immediate:!1,callback(h){h&&h===st&&T()}}),E=ee();async function y(){var h;b.value=!0;try{await((h=L.value)==null?void 0:h.validate());let s;i.type==="account"?s={username:i.username,password:i.password}:s={mobile:i.mobile,code:i.code,type:"mobile"};const{data:d}=await te(s);x.value=JSON.stringify({token:d==null?void 0:d.token,expires:d==null?void 0:d.expire}),n.success({message:"登录成功",description:"欢迎回来！",duration:3});const $=He("redirect","/");await E.getUserInfo();const v=await E.generateDynamicRoutes();u.addRoute(v),await u.push({path:$,replace:!0})}catch(s){n.error({message:`登录失败${s}`,description:s instanceof Error?s.message:"请联系管理员",duration:3}),s instanceof oe&&(I.value=!0),b.value=!1}}return le(async()=>{await ge(300),A.init(t(S))}),de(()=>{A.removeListeners()}),(h,s)=>{const d=Pe,$=Ae,v=be,F=ye,P=$e,V=ke,H=Me,R=ze,K=Ce,O=Le,W=ve;return _(),w("div",De,[a("div",Je,[a("canvas",{ref_key:"bubbleCanvas",ref:S},null,512)]),a("div",Qe,[a("div",je,[a("div",Xe,[Ye,a("div",Ge,[a("span",{class:"flex-center cursor-pointer text-16px",onClick:s[0]||(s[0]=g=>t(r).toggleTheme(t(l).theme==="dark"?"light":"dark"))},[t(l).theme==="light"?(_(),M(d,{key:0})):(_(),M($,{key:1}))])])]),c(v,{"m-0":""}),a("div",et,[tt,c(v,{"m-0":"",type:"vertical",class:"ant-pro-login-divider min-h-[520px]"}),a("div",ot,[nt,c(W,{ref_key:"formRef",ref:L,model:t(i)},{default:m(()=>[c(P,{activeKey:t(i).type,"onUpdate:activeKey":s[1]||(s[1]=g=>t(i).type=g),centered:""},{default:m(()=>[c(F,{key:"account",tab:t(p)("pages.login.accountLogin.tab")},null,8,["tab"])]),_:1},8,["activeKey"]),t(I)&&t(i).type==="account"?(_(),M(V,{key:0,"mb-24px":"",message:t(p)("pages.login.accountLogin.errorMessage"),type:"error","show-icon":""},null,8,["message"])):q("",!0),t(i).type==="account"?(_(),w(ue,{key:1},[c(R,{name:"username",rules:[{required:!0,message:t(p)("pages.login.username.required")}]},{default:m(()=>[c(H,{value:t(i).username,"onUpdate:value":s[2]||(s[2]=g=>t(i).username=g),"allow-clear":"",autocomplete:"off",placeholder:t(p)("pages.login.username.placeholder"),size:"large",onPressEnter:y},{prefix:m(()=>[c(t(we))]),_:1},8,["value","placeholder"])]),_:1},8,["rules"]),c(R,{name:"password",rules:[{required:!0,message:t(p)("pages.login.password.required")}]},{default:m(()=>[c(K,{value:t(i).password,"onUpdate:value":s[3]||(s[3]=g=>t(i).password=g),"allow-clear":"",placeholder:t(p)("pages.login.password.placeholder"),size:"large",autocomplete:"current-password",onPressEnter:y},{prefix:m(()=>[c(t(xe))]),_:1},8,["value","placeholder"])]),_:1},8,["rules"])],64)):q("",!0),c(O,{type:"primary",block:"",loading:t(b),size:"large",onClick:y},{default:m(()=>[pe(me(t(p)("pages.login.submit")),1)]),_:1},8,["loading"])]),_:1},8,["model"])])])])])])}}});const pt=z(at,[["__scopeId","data-v-d9ce77c5"]]);export{pt as default};
