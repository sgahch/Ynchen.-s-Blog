import{a as X,e as Y,h as R,b as Z}from"./index-2a334394.js";import{$ as _,S as U,a as H,r as j,w as p,ax as O,s as E,j as t}from"./vue-5b89248e.js";function se(e){return{type:String,default:e}}function ce(e){return{type:Number,default:e}}function le(e){return{type:Boolean,default:e}}function oe(e){return{type:Array,default:e}}function ue(){return{type:[Function,Array]}}function D(e,...f){if(typeof e=="function")return e(...f);if(Array.isArray(e))return e.map(h=>h(...f))}function P(e,f,h=[]){e.forEach(l=>{f.set(l.path,{...l,matched:h}),l.children&&l.children.length&&P(l.children,f,[...h,l])})}const ie=_("layout-menu",()=>{const e=X(),f=Y(),{layoutSetting:h}=U(f),l=H(new Map),y=j([]),c=j([]),b=()=>{var M;const n=R.currentRoute.value,i=((M=n.meta)==null?void 0:M.originPath)??n.path;if(l.has(i)){const s=l.get(i);if(y.value=[],s&&(s.parentKeys&&s.parentKeys.length?y.value=s.parentKeys:y.value=[s.path]),s!=null&&s.matched){const S=s.matched.map(r=>r.path);h.value.accordionMode?c.value=S:c.value=[...new Set([...c.value,...S])]}}};p(()=>e.menuData,n=>{P(n,l),b()},{immediate:!0,flush:"post"});const{menuData:k}=U(e),v=n=>{var S;const i=(S=k.value)==null?void 0:S.map(r=>r.path),M=n.filter(r=>{var g;return(g=c.value)==null?void 0:g.includes(r)}),s=n.concat(c.value).filter(r=>!M.includes(r))[0];if(i!=null&&i.includes(s))switch(n.includes(s)){case!0:c.value=[s];break;case!1:c.value=[];break}else switch(n.includes(s)){case!0:c.value=n;break;case!1:c.value=n.slice(0,c.value.indexOf(s));break}},m=n=>{const i=n[0];Z(i)||(y.value=n)},A=n=>{h.value.accordionMode?v(n):c.value=n};return p(R.currentRoute,n=>{n.path!==y.value[0]&&b()}),{selectedKeys:y,openKeys:c,menuDataMap:l,handleSelectedKeys:m,handleOpenKeys:A,changeMenu:b,handleAccordionMode:v,clear:()=>{c.value=[],y.value=[]}}});function ee(e,f={}){const h=E(!1),l=t(()=>e.logo),y=t(()=>e.title),c=t(()=>e.layout),b=t(()=>e.collapsedWidth),k=t(()=>e.siderWidth),v=t(()=>e.menuData),m=t(()=>e.splitMenus),A=t(()=>e.fixedHeader),T=t(()=>e.fixedSider),n=t(()=>e.collapsed),i=t(()=>e.theme),M=t(()=>e.headerHeight),s=t(()=>e.contentWidth),S=t(()=>e.copyright),r=t(()=>e.isMobile),g=E(!1),F=()=>{g.value=!g.value},B=t(()=>e.header),I=t(()=>e.menu),N=t(()=>e.footer),$=t(()=>e.menuHeader),q=t(()=>e.leftCollapsed),w=H(new Map),K=H({selectedKeys:[]});p(v,()=>{var a;w.clear(),(a=v.value)==null||a.forEach(o=>{w.set(o.path,o)})},{immediate:!0});const z=t(()=>{var o,d;if(r.value||c.value!=="mix"||!m.value)return v.value;const a=(o=K.selectedKeys)==null?void 0:o[0];return a?((d=w.get(a))==null?void 0:d.children)??[]:[]}),G=a=>{K.selectedKeys=a},W=t(()=>e.openKeys),x=t(()=>e.selectedKeys),J=a=>{D(e["onUpdate:openKeys"],a)},Q=a=>{D(e["onUpdate:selectedKeys"],a)},V=a=>{D(e.onMenuSelect,a)},C=(a,o,d)=>{for(const u of o??[]){if(u.path===a)return d??u;if(u.children&&u.children.length){const L=C(a,u.children,d??u);if(L)return L}}};return p(x,()=>{var a;if(m.value){const o=(a=x.value)==null?void 0:a[0];if(o){const d=C(o,v.value??[]);d&&(K.selectedKeys=[d.path])}}},{immediate:!0}),p(m,()=>{var a,o;if(!m.value)K.selectedKeys=[];else{const d=((a=x.value)==null?void 0:a[0])??((o=W.value)==null?void 0:o[0])??"",u=C(d,v.value??[]);u?K.selectedKeys=[u==null?void 0:u.path]:K.selectedKeys=[]}}),{logo:l,title:y,layout:c,collapsed:n,leftCollapsed:q,collapsedWidth:b,menuData:v,siderWidth:k,fixedHeader:A,fixedSider:T,headerHeight:M,theme:i,isMobile:r,mobileCollapsed:g,contentWidth:s,copyright:S,hasPageContainer:h,splitMenus:m,splitState:K,menuDataMap:w,selectedMenus:z,handleMobileCollapsed:F,header:B,menu:I,footer:N,openKeys:W,handleOpenKeys:J,selectedKeys:x,handleSelectedKeys:Q,handleMenuSelect:V,handleSplitSelectedKeys:G,menuHeader:$,...f}}const[re,te]=O(ee),de=()=>te();export{de as a,oe as b,le as c,re as d,ue as e,ce as n,se as s,ie as u};
