import{_ as le}from"./index-0deb4903.js";import{v as ie,y as se,z as de,B as ue,_ as ce}from"./index-2a334394.js";import pe from"./modal-42a2bfbe.js";import{m as U,X as re,Y as _e,S as me,y as fe,J as ye,ar as ve,a0 as ge,as as xe}from"./antd-a1128520.js";import{d as he,h as ke,r as s,a as we,o as Ie,a0 as w,a1 as c,a2 as v,a3 as t,c as o,u as l,E as p,a8 as g,a5 as $,F as V,aj as Ce,af as L,a6 as De,a7 as be}from"./vue-5b89248e.js";import"./index.vue_vue_type_script_setup_true_lang-be6d18e9.js";import"./chunk-YXBPAIHU-f2871816.js";import"./context-6a3352c8.js";const O=x=>(De("data-v-12c102c5"),x=x(),be(),x),Oe=O(()=>g("span",{style:{"margin-inline-start":"1px"}},"修改",-1)),Me=O(()=>g("span",{style:{"margin-inline-start":"1px"}},"新增",-1)),Ae=O(()=>g("span",{style:{"margin-inline-start":"1px"}},"删除",-1)),Fe=he({__name:"index",setup(x,{expose:P}){P({h:ke});const r=s(!0),I=s(!1),C=s(),_=we({username:"",status:void 0});async function Y(e){if(e.username===""&&e.status===void 0){k();return}r.value=!0;const{data:n}=await se(1,e.username,e.status);r.value=!1,h.value=n}function j(e){console.log("出现错误:",e)}const z=s([{title:"菜单名称",dataIndex:"title",width:"10%",align:"center"},{title:"图标",dataIndex:"icon",width:"2%",key:"icon",align:"center"},{title:"排序",dataIndex:"orderNum",width:"2%",align:"center"},{title:"组件路径",dataIndex:"component",width:"10%",align:"center"},{title:"状态",dataIndex:"isDisable",key:"isDisable",width:"5%",align:"center"},{title:"创建时间",dataIndex:"createTime",width:"14%",align:"center"},{title:"操作",key:"operation",width:"10%",align:"center"}]);Ie(()=>{F()});const M=s(),h=s([]),A=s();async function F(){const{data:e}=await ie(1);M.value=e,h.value=S(e),A.value=S(e),r.value=!1}function S(e){let n=e.filter(a=>a.parentId===null);return n.forEach(a=>{a.key=a.id;let i=T(a,e);i.length>0&&(a.children=i)}),n}function T(e,n){let a=n.filter(i=>i.parentId===e.id);return a.forEach(i=>{i.key=i.id;let m=T(i,n);m.length>0&&(i.children=m)}),a}const d=s({expandedRowKeys:[],flag:!1});function J(){d.value.flag?(d.value.expandedRowKeys=[],d.value.flag=!1):(d.value.expandedRowKeys=M.value.map(e=>e.id),d.value.flag=!0)}function X(e,n){if(e)d.value.expandedRowKeys.push(n.key);else{const a=d.value.expandedRowKeys.indexOf(n.key);a>-1&&d.value.expandedRowKeys.splice(a,1)}}function k(){r.value=!0,F()}const R=e=>{e==="add"?(b.value=0,C.value="添加菜单"):e==="update"&&(b.value=1,C.value="修改菜单"),I.value=!0};function q(e){I.value=e}function G(){k()}const D=s(),b=s(null);async function H(e){const{data:n}=await de(e);n.roleId||(n.roleId=void 0),D.value=n,R("update")}function B(e,n){const a={id:"",parentId:"",title:"",orderNum:0,roleId:void 0,icon:"",routerType:0,component:"",redirect:"",url:"",path:"",target:"",affix:0,keepAlive:1,hideInMenu:0,isDisable:0};n!==void 0&&(a.parentId=n),D.value=a,R(e)}async function Q(e){(await ue(e).catch(a=>{U.warn(a)})).code===200&&(U.success("菜单删除成功"),k())}return(e,n)=>{const a=re,i=_e,m=me,W=fe,E=w("PlusOutlined"),f=ye,Z=w("ArrowsAltOutlined"),ee=w("FileSyncOutlined"),ne=w("DeleteOutlined"),te=ve,K=ge,ae=xe,oe=le;return c(),v(oe,{"onUpdate:refreshFunc":k,"onUpdate:onFinish":Y,"onUpdate:onFinishFailed":j,formState:l(_)},{"form-items":t(()=>[o(i,{label:"菜单名称",name:"username"},{default:t(()=>[o(a,{value:l(_).username,"onUpdate:value":n[0]||(n[0]=u=>l(_).username=u),placeholder:"请输入菜单名称"},null,8,["value"])]),_:1}),o(i,{label:"状态",name:"status",style:{width:"240px"}},{default:t(()=>[o(W,{value:l(_).status,"onUpdate:value":n[1]||(n[1]=u=>l(_).status=u),placeholder:"菜单状态"},{default:t(()=>[o(m,{value:0},{default:t(()=>[p(" 正常 ")]),_:1}),o(m,{value:1},{default:t(()=>[p(" 停用 ")]),_:1})]),_:1},8,["value"])]),_:1})]),"operate-btn":t(()=>[g("div",null,[o(f,{onClick:n[2]||(n[2]=u=>B("add")),type:"primary"},{icon:t(()=>[o(E)]),default:t(()=>[p(" 新增 ")]),_:1}),o(f,{type:"dashed",style:{"margin-bottom":"10px",color:"grey"},onClick:J},{icon:t(()=>[o(Z)]),default:t(()=>[p(" 展开/折叠 ")]),_:1})])]),"table-content":t(()=>[g("div",null,[o(ae,{columns:l(z),"data-source":l(h),"expanded-row-keys":l(d).expandedRowKeys,onExpand:X,loading:l(r)},{bodyCell:t(({column:u,record:y})=>[u.key==="operation"?(c(),$(V,{key:0},[o(f,{type:"link",style:{padding:"0"},onClick:N=>H(y.id)},{icon:t(()=>[o(ee)]),default:t(()=>[Oe]),_:2},1032,["onClick"]),o(f,{type:"link",style:{padding:"0","margin-left":"5px"},onClick:N=>B("add",y.parentId)},{icon:t(()=>[o(E)]),default:t(()=>[Me]),_:2},1032,["onClick"]),o(te,{title:"是否确定删除","ok-text":"Yes","cancel-text":"No",onConfirm:N=>Q(y.id)},{default:t(()=>[o(f,{type:"link",style:{padding:"0","margin-left":"5px"}},{icon:t(()=>[o(ne)]),default:t(()=>[Ae]),_:1})]),_:2},1032,["onConfirm"])],64)):u.key==="isDisable"?(c(),$(V,{key:1},[y.isDisable?(c(),v(K,{key:0,color:"green"},{default:t(()=>[p("正常")]),_:1})):(c(),v(K,{key:1,color:"red"},{default:t(()=>[p("停用")]),_:1}))],64)):u.key==="icon"?(c(),v(Ce(y.icon),{key:2})):L("",!0)]),_:1},8,["columns","data-source","expanded-row-keys","loading"])]),l(h).length>0?(c(),v(pe,{key:0,modalOpen:l(I),modalTitle:l(C),"onUpdate:modalOpen":q,"onAdd:success":G,menuData:l(A),formData:l(D),modalType:l(b)},null,8,["modalOpen","modalTitle","menuData","formData","modalType"])):L("",!0)]),_:1},8,["formState"])}}});const $e=ce(Fe,[["__scopeId","data-v-12c102c5"]]);export{$e as default};
